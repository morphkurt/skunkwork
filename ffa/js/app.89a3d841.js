(function(t){function e(e){for(var n,c,o=e[0],s=e[1],l=e[2],f=0,d=[];f<o.length;f++)c=o[f],Object.prototype.hasOwnProperty.call(r,c)&&r[c]&&d.push(r[c][0]),r[c]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n]);u&&u(e);while(d.length)d.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],n=!0,o=1;o<a.length;o++){var s=a[o];0!==r[s]&&(n=!1)}n&&(i.splice(e--,1),t=c(c.s=a[0]))}return t}var n={},r={app:0},i=[];function c(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,c),a.l=!0,a.exports}c.m=t,c.c=n,c.d=function(t,e,a){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(c.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)c.d(a,n,function(e){return t[e]}.bind(null,n));return a},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/ffa/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],s=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=s;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},1:function(t,e){},"2d55":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("Main",{attrs:{msg:"Welcome to Your Vue.js App"}})],1)},i=[],c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container max-w-4xl my-10"},[a("div",{staticClass:"bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4"},[a("h1",{staticClass:"text-xl text-center pb-3"},[t._v(t._s(t.title))]),a("div",{staticClass:"flex-col"},[a("div",{staticClass:"flex flex-row h-px-100"},[a("div",{staticClass:"w-4/5"},[a("video",{ref:"videoPlayer",staticClass:"video-js vjs-fluid",attrs:{id:"video"},on:{timeupdate:function(e){return t.onTimeUpdate(e)},loadedmetadata:function(e){return t.onLoadedMetadata(e)}}})]),a("div",{staticClass:"flex flex-no-wrap overflow-y-scroll flex-col w-1/5 shadow-md ml-3 border-gray-200 border-1"},t._l(t.keyEvents,(function(e,n){return a("div",{key:n,staticClass:"moment",on:{click:function(a){return t.skip(e.videoTime)}}},[t._v(" "+t._s(e.event)+" ")])})),0)]),t._m(0),a("div",{staticClass:"text-xs mt-3 whitespace-pre"},[a("ul",{staticClass:"flex"},[a("li",{staticClass:"flex-1 mr-2"},[a("a",{staticClass:"text-center block border border-blue-500 rounded py-2 px-4 bg-blue-500 hover:bg-blue-700 text-white",attrs:{href:"#"},on:{click:function(e){t.ActiveCalibrate=!0,t.ActiveWebVTT=!1,t.calibrate()}}},[t._v("Calibrate")])]),a("li",{staticClass:"flex-1 mr-2"},[a("a",{staticClass:"text-center block border border-blue-500 rounded py-2 px-4 bg-blue-500 hover:bg-blue-700 text-white",attrs:{href:"#"},on:{click:function(e){t.ActiveCalibrate=!1,t.ActiveWebVTT=!0}}},[t._v("WebVTT")])])])]),t.ActiveWebVTT?a("div",{staticClass:"overflow-x-scroll text-xs mt-3 whitespace-pre"},[a("p",[t._v(t._s(t.webvtt))])]):t._e(),t.ActiveCalibrate?a("div",{staticClass:"text-xs mt-3 whitespace-pre"},[a("table",{staticClass:"table-auto object-center"},[t._m(1),a("tbody",t._l(t.calbrateData,(function(e,n){return a("tr",{key:n,on:{click:function(a){return t.player.currentTime(e.time)}}},[a("td",{staticClass:"border px-4 py-2"},[t._v(t._s(n))]),a("td",{staticClass:"border px-4 py-2"},[t._v(t._s(e.matchtime))]),a("td",{staticClass:"border px-4 py-2"},[t._v(t._s(e.time))]),a("td",{staticClass:"border px-4 py-2"},[t._v(" "+t._s(Math.floor(e.matchtime/60)+":"+e.matchtime%60)+" ")]),a("td",{staticClass:"border px-4 py-2"},[t._v(" "+t._s(Math.floor(e.time/60)+":"+e.time%60)+" ")]),a("td",{staticClass:"border px-4 py-2"},[t._v(" "+t._s(e.matchtime-e.time)+" ")]),a("td",{staticClass:"border px-4 py-2"},[t._v(" "+t._s(e.half)+" ")])])})),0)])]):t._e()])])])},o=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("canvas",{staticClass:"hidden",attrs:{id:"canvas"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{staticClass:"px-4 py-2"},[t._v("Sample")]),a("th",{staticClass:"px-4 py-2"},[t._v("Match Time (s)")]),a("th",{staticClass:"px-4 py-2"},[t._v("Video Time (s)")]),a("th",{staticClass:"px-4 py-2"},[t._v("Match Time")]),a("th",{staticClass:"px-4 py-2"},[t._v("Video Time")]),a("th",{staticClass:"px-4 py-2"},[t._v("Offset")]),a("th",{staticClass:"px-4 py-2"},[t._v("Half")])])])}],s=(a("4de4"),a("b0c0"),a("a9e3"),a("d3b7"),a("ac1f"),a("25f0"),a("3ca3"),a("4d90"),a("841c"),a("1276"),a("ddb0"),a("2b3d"),a("96cf"),a("1da1")),l=a("f0e2"),u={name:"VideoPlayer",props:{videoOptions:{type:Object,default:function(){return{}}}},data:function(){return{ActiveWebVTT:!1,calbrateData:[],ActiveCalibrate:!1,bcData:{},video:null,webvtt:"",matchOffsetData:null,canvas:null,ctx:null,keyEvents:[],title:null,matchInfo:{},matchId:null,currentTime:0,matchData:{},player:null,options:{autoplay:!0,controls:!0},playerKey:"BCpkADawqM2QQRAICfpf23j4hDi7g-UlKZp6rNqo3jReJFEfkuhnjOfjJTUOryo27EoXjggPUBbgzBpPvNY7p-YM4Me1Sx3Khpn-FkMQqP5x66s_ULssIqU3V6C2s7odORMP7L_iAyuGwexk"}},mounted:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new URLSearchParams(window.location.search),t.canvas=document.getElementById("canvas"),t.video=document.getElementById("video"),t.ctx=t.canvas.getContext("2d"),e.next=6,t.getBC(a.get("videoId"));case 6:t.bcData=e.sent,t.title=t.bcData.name,t.matchId=t.bcData.custom_fields.matchid,t.getMatchData().then((function(e){t.keyEvents=e})),t.createwebvtt(),t.options.sources=t.bcData.sources,t.player=Object(l["a"])(t.$refs.videoPlayer,t.options,(function(){console.log("onPlayerReady",this)}));case 13:case"end":return e.stop()}}),e)})))()},beforeDestroy:function(){this.player&&this.player.dispose()},methods:{calibrate:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a,n,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.calbrateData=[],a=regeneratorRuntime.mark((function e(a){var n,i,c,o,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=300*a,t.player.currentTime(r),t.player.pause(),e.next=5,t.readText();case 5:n=e.sent,i=/^[\d+]*:[\d+]*$/gm,c=n.TextDetections.filter((function(t){return i.test(t.DetectedText)})),o=c[0]&&60*Number(c[0].DetectedText.split(":")[0])+Number(c[0].DetectedText.split(":")[1]),s=void 0,o<2700?s="FirstHalf":o>2700&&o<5400?s="SecondHalf":o>5400&&o<6300?s="ExtraFirstHalf":o>6300&&o<7200&&(s="ExtraSecondHalf"),c[0]&&t.calbrateData.push({time:n.time,matchtime:o,offset:n.time-o,half:s});case 12:case"end":return e.stop()}}),e)})),n=1;case 3:if(!(n<Math.ceil(t.player.duration()/300))){e.next=8;break}return e.delegateYield(a(n),"t0",5);case 5:n++,e.next=3;break;case 8:return i={},i.FirstHalf=Math.abs(t.calbrateData.filter((function(t){if("FirstHalf"==t.half)return t}))[0].offset),i.SecondHalf=Math.abs(t.calbrateData.filter((function(t){if("SecondHalf"==t.half)return t}))[0].offset),t.calbrateData.filter((function(t){if("ExtraFirstHalf"==t.half)return t})).length>0&&(i.ExtraFirstHalf=Math.abs(t.calbrateData.filter((function(t){if("ExtraFirstHalf"==t.half)return t}))[0].offset),t.calbrateData.filter((function(t){if("ExtraSecondHalf"==t.half)return t})).length>0&&(i.ExtraSecondHalf=Math.abs(t.calbrateData.filter((function(t){if("ExtraSecondHalf"==t.half)return t}))[0].offset))),t.matchOffsetData=i,e.next=15,t.getMatchData();case 15:t.keyEvents=e.sent,console.log(i);case 17:case"end":return e.stop()}}),e)})))()},onTimeUpdate:function(){this.currentTime=this.player.currentTime(),this.captureVideo()},captureVideo:function(){var t=this;return new Promise((function(e,a){var n=t.canvas.height/t.video.videoHeight*t.video.videoWidth;e(t.ctx.drawImage(t.video,0,0,n,t.canvas.height)),t.canvas.onerror=a}))},readText:function(){var t=new Headers;t.append("Content-Type","application/json");var e=JSON.stringify({image:this.canvas.toDataURL("img/png").split("data:image/png;base64,")[1],time:this.currentTime}),a={method:"POST",headers:t,body:e,redirect:"follow"};return new Promise((function(t,e){fetch("https://byfset8uye.execute-api.ap-southeast-2.amazonaws.com/default/FFAScoreReader",a).then((function(t){return t.json()})).then((function(e){return t(e)})).catch((function(t){return e(t)}))}))},onLoadedMetadata:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:console.log("player loaded Data!",t),console.log(e.player.duration()),e.canvas.width=640,e.canvas.height=360;case 4:case"end":return a.stop()}}),a)})))()},createwebvtt:function(){var t=this;this.getWebvtt().then((function(e){t.webvtt=e}))},convertSecondstoTime:function(t){var e=Math.floor(t/3600),a=Math.floor((t-3600*e)/60),n=t-3600*e-60*a,r=e.toString().padStart(2,"0")+":"+a.toString().padStart(2,"0")+":"+n.toString().padStart(2,"0")+".000";return r},skip:function(t){this.player.currentTime(t)},extractMatchInfo:function(){},getWebvtt:function(){var t=this;return new Promise((function(e,a){var n={method:"GET",redirect:"follow"};fetch("https://0l60wuyvp6.execute-api.ap-southeast-2.amazonaws.com/ffa/m".concat(t.matchId,".webvtt"),n).then((function(t){return t.text()})).then((function(t){return e(t)})).catch((function(t){return a(t)}))}))},getMatchData:function(){var t=this;return new Promise((function(e,a){var n={method:"GET",redirect:"follow"};fetch("https://0l60wuyvp6.execute-api.ap-southeast-2.amazonaws.com/ffa/m".concat(t.matchId,".json"),n).then((function(t){return t.json()})).then((function(t){return e(t)})).catch((function(t){return a(t)}))}))},getBC:function(t){return new Promise((function(e,a){var n=new Headers;n.append("Accept","application/json;pk=BCpkADawqM2QQRAICfpf23j4hDi7g-UlKZp6rNqo3jReJFEfkuhnjOfjJTUOryo27EoXjggPUBbgzBpPvNY7p-YM4Me1Sx3Khpn-FkMQqP5x66s_ULssIqU3V6C2s7odORMP7L_iAyuGwexk");var r={method:"GET",headers:n,redirect:"follow"};fetch("https://edge.api.brightcove.com/playback/v1/accounts/6058022062001/videos/".concat(t),r).then((function(t){return t.json()})).then((function(t){return e(t)})).catch((function(t){return a(t)}))}))}}},f=u,d=(a("aa63"),a("2877")),p=Object(d["a"])(f,c,o,!1,null,"67a1aa72",null),h=p.exports,v={name:"App",components:{Main:h}},m=v,b=Object(d["a"])(m,r,i,!1,null,null,null),x=b.exports;a("def6"),a("fda2");n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(x)}}).$mount("#app")},aa63:function(t,e,a){"use strict";a("2d55")},def6:function(t,e,a){}});
//# sourceMappingURL=app.89a3d841.js.map